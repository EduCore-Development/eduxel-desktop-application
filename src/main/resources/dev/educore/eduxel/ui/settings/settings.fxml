<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="dev.educore.eduxel.ui.settings.SettingsController"
            stylesheets="@../main/main-theme.css">

    <center>
        <VBox spacing="16" styleClass="content-area">
            <padding>
                <Insets topRightBottomLeft="16"/>
            </padding>

            <HBox alignment="CENTER_LEFT" spacing="10">
                <Label text="Einstellungen" styleClass="activity-title"/>
                <Label text="Server-Verbindung konfigurieren" styleClass="activity-subtitle"/>
            </HBox>

            <GridPane hgap="12" vgap="10">
                <columnConstraints>
                    <ColumnConstraints/>
                    <ColumnConstraints hgrow="ALWAYS"/>
                </columnConstraints>

                <Label text="Server-IP/Host" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                <TextField fx:id="hostField"
                           promptText="z. B. 192.168.1.10 oder server.schule.de"
                           GridPane.rowIndex="0" GridPane.columnIndex="1"/>

                <Label text="Port" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                <TextField fx:id="portField"
                           promptText="45821"
                           GridPane.rowIndex="1" GridPane.columnIndex="1"/>

                <Label text="Secret" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                <PasswordField fx:id="secretField"
                               promptText="Secret"
                               GridPane.rowIndex="2" GridPane.columnIndex="1"/>

                <HBox spacing="8"
                      alignment="CENTER_LEFT"
                      GridPane.rowIndex="3"
                      GridPane.columnIndex="0"
                      GridPane.columnSpan="2">
                    <ProgressIndicator fx:id="progress"
                                       visible="false"
                                       prefWidth="18"
                                       prefHeight="18"/>
                    <Label fx:id="statusLabel" text=""/>
                </HBox>
            </GridPane>

            <HBox spacing="10" alignment="CENTER_RIGHT">
                <Button text="Verbindung testen"
                        onAction="#onTestConnection"
                        styleClass="pill-button"/>
                <Button fx:id="saveButton"
                        text="Speichern"
                        onAction="#onSave"
                        styleClass="primary-button"/>
            </HBox>

            <Separator/>

            <VBox spacing="12" styleClass="activity-card" style="-fx-background-color: rgba(254, 242, 242, 0.6); -fx-border-color: rgba(220, 38, 38, 0.2); -fx-border-width: 1; -fx-border-radius: 14; -fx-background-radius: 14;">
                <padding>
                    <Insets topRightBottomLeft="16"/>
                </padding>

                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="⚠" style="-fx-font-size: 22; -fx-text-fill: #dc2626; -fx-font-weight: bold;"/>
                    <VBox spacing="4">
                        <Label text="Gefahrenzone" styleClass="activity-subtitle" style="-fx-text-fill: #dc2626; -fx-font-weight: 700;"/>
                        <Label text="Ausloggen und alle lokalen Einstellungen löschen" style="-fx-text-fill: #991b1b; -fx-font-size: 11;"/>
                    </VBox>
                </HBox>

                <Label text="Alle gespeicherten Verbindungsdaten (Server-IP, Port, Secret) werden gelöscht. Die Datenbank bleibt unverändert."
                       wrapText="true"
                       style="-fx-text-fill: #7f1d1d; -fx-font-size: 12;"/>

                <Button text="Ausloggen &amp; Zurücksetzen"
                        onAction="#onLogout"
                        style="-fx-background-color: #dc2626; -fx-text-fill: white; -fx-font-weight: 600; -fx-background-radius: 10; -fx-padding: 10 20 10 20;"
                        maxWidth="Infinity"/>
            </VBox>

            <Separator/>

            <VBox spacing="6">
                <Label text="Build-Informationen" styleClass="activity-subtitle"/>
                <Label fx:id="buildInfoLabel"/>

                <HBox spacing="12">
                    <Hyperlink onAction="#onOpenBugReport">
                        <graphic>
                            <FontIcon iconLiteral="mdi2b-bug-outline" iconSize="14"/>
                        </graphic>
                        <text>Bug melden</text>
                    </Hyperlink>

                    <Hyperlink onAction="#onOpenGithub">
                        <graphic>
                            <FontIcon iconLiteral="mdi2b-book-open-outline" iconSize="14"/>
                        </graphic>
                        <text>GitHub öffnen</text>
                    </Hyperlink>
                </HBox>
            </VBox>
        </VBox>
    </center>

    <padding>
        <Insets topRightBottomLeft="16"/>
    </padding>
</BorderPane>
